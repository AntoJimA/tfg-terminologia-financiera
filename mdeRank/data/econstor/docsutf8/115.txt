Optimal redistributive taxation with both extensive and intensive responses â€” We derive a general optimal income tax formula when individuals respond along both the intensive and extensive margins and when income effects can prevail. Individuals are heterogeneous across two dimensions: their skill and their disutility of participation. Preferences over consumption and work effort can differ with respect to the level of skill, with only the Spence-Mirrlees condition being imposed. Employing a new tax perturbation approach that integrates the nonlinearity of the tax function into the behavioral elasticities, we derive a fairly mild condition for optimal marginal tax rates to be nonnegative everywhere. Numerical simulations using U.S. data confirm the mildness of our conditions. The extensive margin strongly reduces the level of optimal marginal tax rates.